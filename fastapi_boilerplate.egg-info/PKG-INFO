Metadata-Version: 2.4
Name: fastapi-boilerplate
Version: 1.0.0
Summary: FastAPI boilerplate with PostgreSQL + MongoDB support
Author-email: Your Name <your.email@example.com>
License: MIT
Keywords: fastapi,api,boilerplate,postgresql,mongodb
Requires-Python: >=3.12
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: fastapi>=0.115.0
Requires-Dist: uvicorn[standard]>=0.32.0
Requires-Dist: pydantic>=2.9.0
Requires-Dist: pydantic-settings>=2.6.0
Requires-Dist: python-multipart>=0.0.9
Requires-Dist: httpx>=0.27.0
Requires-Dist: sqlalchemy[asyncio]>=2.0.35
Requires-Dist: asyncpg>=0.29.0
Requires-Dist: alembic>=1.13.0
Requires-Dist: motor>=3.6.0
Requires-Dist: beanie>=1.26.0
Requires-Dist: pymongo>=4.6.1
Requires-Dist: python-jose[cryptography]>=3.3.0
Requires-Dist: passlib[bcrypt]>=1.7.4
Requires-Dist: email-validator>=2.2.0
Requires-Dist: python-dotenv>=1.0.0
Requires-Dist: structlog>=24.4.0
Dynamic: license-file

# FastAPI Boilerplate

Production-ready FastAPI boilerplate with PostgreSQL + MongoDB support, designed for quick MVP development.

## Features

- **FastAPI** with async support
- **Dual Database**: PostgreSQL + MongoDB (use one or both)
- **Authentication**: JWT with access/refresh tokens
- **Role-Based Permissions**: Flexible RBAC system
- **Repository Pattern**: Clean data access abstraction
- **Service Layer**: Business logic separation
- **Structured Logging**: JSON logs with structlog
- **Docker Compose**: Complete development environment
- **Alembic**: Database migrations for PostgreSQL
- **Testing**: Pytest with async support

## Quick Start

### Prerequisites

- Python 3.12+
- [UV](https://docs.astral.sh/uv/) (Python package manager)
- Docker & Docker Compose

### Setup

```bash
# Clone the repository
git clone <your-repo-url>
cd fastapi-boilerplate

# Copy environment file
cp .env.example .env

# Install dependencies
make install

# Start databases
make docker-up

# Run migrations
make db-upgrade

# Initialize database with admin user
make db-init

# Start development server
make dev
```

The API will be available at `http://localhost:8000`.

### Default Admin Credentials

- **Email**: admin@example.com
- **Password**: admin123

**Change these immediately in production!**

## Project Structure

```
.
├── app/
│   ├── api/
│   │   ├── v1/           # API version 1 endpoints
│   │   │   ├── auth.py   # Authentication endpoints
│   │   │   ├── users.py  # User CRUD endpoints
│   │   │   └── items.py  # Example CRUD endpoints
│   │   ├── deps.py       # Dependency injection
│   │   └── handlers.py   # Exception handlers
│   │
│   ├── core/
│   │   ├── exceptions.py # Custom exceptions
│   │   ├── logging.py    # Structured logging
│   │   ├── permissions.py# Role-based access control
│   │   ├── security.py   # JWT & password utils
│   │   └── alerts.py     # Telegram alerts (optional)
│   │
│   ├── db/
│   │   ├── postgres.py   # PostgreSQL connection
│   │   ├── mongodb.py    # MongoDB connection
│   │   └── unit_of_work.py # Cross-DB transactions
│   │
│   ├── models/
│   │   ├── postgres/     # SQLAlchemy models
│   │   │   ├── user.py
│   │   │   └── item.py
│   │   └── mongodb/      # Beanie documents
│   │       └── document.py
│   │
│   ├── repositories/     # Data access layer
│   │   ├── base.py
│   │   ├── user_repo.py
│   │   └── item_repo.py
│   │
│   ├── schemas/          # Pydantic DTOs
│   │   ├── auth.py
│   │   ├── user.py
│   │   └── item.py
│   │
│   ├── services/         # Business logic
│   │   ├── auth_service.py
│   │   ├── user_service.py
│   │   └── item_service.py
│   │
│   ├── config.py         # Application settings
│   └── main.py           # Application entry point
│
├── alembic/              # Database migrations
├── scripts/              # Initialization scripts
├── tests/                # Test suite
├── docker-compose.yml    # Development containers
├── Makefile              # Development commands
└── pyproject.toml        # Project configuration
```

## Available Commands

```bash
make help           # Show all commands

# Development
make dev            # Start development server
make shell          # Open Python shell

# Database
make db-migrate     # Create new migration
make db-upgrade     # Apply migrations
make db-downgrade   # Revert last migration
make db-init        # Initialize with seed data

# Code Quality
make format         # Format code with Ruff
make lint           # Check code style
make type-check     # Run MyPy type checking
make check          # Run all quality checks

# Testing
make test           # Run all tests
make test-unit      # Run unit tests
make test-cov       # Run with coverage

# Docker
make docker-up      # Start containers
make docker-down    # Stop containers
make docker-logs    # View logs
make docker-tools   # Start with PgAdmin & Mongo Express

# Setup
make setup          # Complete project setup
make reset          # Reset environment
make clean          # Clean temp files
```

## Configuration

All configuration is done via environment variables. See `.env.example` for all options.

### Database Options

This boilerplate supports both PostgreSQL and MongoDB. You can use:

1. **Both databases** (default): Use PostgreSQL for structured data and MongoDB for flexible documents
2. **PostgreSQL only**: Remove MongoDB-related code (see comments in code)
3. **MongoDB only**: Remove PostgreSQL-related code (see comments in code)

### Role-Based Permissions

The permission system is defined in `app/core/permissions.py`:

```python
# Define permissions
class Permission(str, Enum):
    USERS_READ = "users:read"
    USERS_CREATE = "users:create"
    # Add more...

# Define roles with permission sets
ROLE_PERMISSIONS = {
    Role.ADMIN: {Permission.USERS_READ, Permission.USERS_CREATE, ...},
    Role.USER: {Permission.ITEMS_READ, ...},
}

# Use in endpoints
@router.get("/admin/users")
async def admin_list_users(
    current_user: User = Depends(require_permissions(Permission.USERS_READ))
):
    ...
```

## API Documentation

Once running, access the API docs at:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## Development Tools

Start with optional tools (PgAdmin & Mongo Express):

```bash
make docker-tools
```

- **PgAdmin**: http://localhost:5050 (admin@local.dev / admin)
- **Mongo Express**: http://localhost:8081 (admin / admin)

## Testing

```bash
# Run all tests
make test

# Run with coverage
make test-cov

# Run specific tests
uv run pytest tests/unit -v
uv run pytest tests/integration -v
```

## Deployment

### Production Checklist

1. Change `SECRET_KEY` (use `make generate-secret`)
2. Set `DEBUG=false`
3. Set `ENVIRONMENT=production`
4. Update CORS origins
5. Change default admin password
6. Configure proper database credentials
7. Set up Telegram alerts (optional)

### Docker Production

```bash
# Build production image
docker build -f Dockerfile -t your-app:latest .

# Run with production settings
docker run -e ENVIRONMENT=production your-app:latest
```

## Customization Guide

### Adding a New Model (PostgreSQL)

1. Create model in `app/models/postgres/your_model.py`
2. Import in `alembic/env.py`
3. Create migration: `make db-migrate`
4. Apply migration: `make db-upgrade`

### Adding a New Model (MongoDB)

1. Create document in `app/models/mongodb/your_document.py`
2. Register in `app/db/mongodb.py` `init_mongodb()` function

### Adding a New API Endpoint

1. Create schema in `app/schemas/`
2. Create repository in `app/repositories/`
3. Create service in `app/services/`
4. Create router in `app/api/v1/`
5. Register router in `app/api/v1/router.py`
6. Add dependencies in `app/api/deps.py`

### Adding New Permissions

1. Add permission to `Permission` enum in `app/core/permissions.py`
2. Add permission to relevant roles in `ROLE_PERMISSIONS`
3. Use `require_permissions()` in your endpoints

## License

MIT License - feel free to use this boilerplate for any project.
